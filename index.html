<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Добавление карманов на спецодежду</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/main.css">
    <script src="src/meta.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.5.0/model-viewer.min.js"></script>

</head>

<body>
    <div class="header">
        <img src="./assets/logo.png" alt="Logo">
        <h1>Дизайн спецодежды</h1>
        <p>Создайте уникальный дизайн для вашей спецодежды, добавляя карманы, материалы и фасоны.</p>
    </div>
    <div class="container">
        <div id="pocket-size-container">
            <input type="range" id="pocket-size" min="20" max="480" value="50" oninput="updatePocketSize(this.value)">
            <label for="pocket-size">Размер кармана:</label>
        </div>
        <div class="button-container">
            <div class="color-picker">
                <input type="color" id="color-picker" value="#cccccc">
            </div>
            <div class="add-pocket-container">
                <button class="add-pocket-button" onclick="openModal()"><i class="fas fa-plus"></i> Добавить
                    карман</button>
            </div>
            <div class="materials-container">
                <button class="add-pocket-button" onclick="openMaterialsModal()"><i class="fas fa-cogs"></i>
                    Материалы</button>
            </div>
            <div class="styles-container">
                <button class="add-pocket-button" onclick="openStylesModal()"><i class="fas fa-tshirt"></i>
                    Фасоны</button>
            </div>
            <div class="aprons-container">
                <button class="add-pocket-button" onclick="openApronsModal()"><i class="fas fa-utensils"></i>
                    Фартуки</button>
            </div>
            <div class="try-on-container">
                <button class="add-pocket-button" onclick="openTryOnModal()"><i class="fas fa-eye"></i>
                    Примерить</button>
            </div>
            <div class="gallery-container">
                <button class="add-pocket-button" onclick="openGalleryModal()"><i class="fas fa-images"></i>
                    Галерея</button>
            </div>
            <div class="save-button-container">
                <button class="add-pocket-button" onclick="saveAsJPEG()"><i class="fas fa-save"></i> Сохранить как
                    JPEG</button>
            </div>
            <div class="fill-button-container">
                <button class="fill-button" onclick="enableFill()"><i class="fas fa-fill-drip"></i> Заливка</button>
            </div>
            <div class="logo-upload-container">
                <input type="file" id="logo-upload" accept="image/*" onchange="uploadLogo(event)">
                <label for="logo-upload"><i class="fas fa-upload"></i> Загрузить логотип</label>
            </div>
            <div class="add-text-container">
                <button class="add-pocket-button" onclick="openTextModal()"><i class="fas fa-font"></i> Добавить
                    текст</button>
            </div>
            <div class="undo-container">
                <button class="add-pocket-button" onclick="undo()"><i class="fas fa-undo"></i> Отменить</button>
            </div>
            <div class="redo-container">
                <button class="add-pocket-button" onclick="redo()"><i class="fas fa-redo"></i> Повторить</button>
            </div>
            <div class="reset-container">
                <button class="add-pocket-button" onclick="resetDesign()"><i class="fas fa-undo"></i> Сбросить</button>
            </div>
            <div class="order-container">
                <button class="add-pocket-button" onclick="placeOrder()"><i class="fas fa-shopping-cart"></i> Оформить
                    заказ</button>
            </div>

        </div>
        <div class="mannequin-container">
            <div class="mannequin" id="mannequin">
                <canvas id="mannequinCanvas" width="800" height="1000"></canvas>
            </div>
            <model-viewer id="color" src="assets/футболка.glb" interaction-prompt="none"
                poster="assets/футболка/футболка.webp" tone-mapping="neutral" shadow-intensity="1"  ar camera-controls
                touch-action="pan-y" disable-tap alt="A 3D model carousel" autoplay camera-orbit="0deg 75deg 100m"
                field-of-view="8deg">

                <div id="ar-prompt">
                    <img src="assets/hand.png">
                </div>

                <button id="ar-failure">
                    AR is not tracking!
                </button>
                <div class="color1div" id="color-controls">
                    <div class="color2div">
                        <button style=background-color:White; id="buton_LightGray" class="color"
                            data-color="#ffffff">White</button>
                        <button style=background-color:red; id="buton_Red" class="color" rs
                            data-color="#ff0000">Red</button>
                        <button style=background-color:Green; id="buton_Green" class="color"
                            data-color="#00ff00">Green</button>
                        <button style=background-color:Blue; id="buton_Blue" class="color"
                            data-color="#0000ff">Blue</button>
                        <button style=background-color:Tomato; id="buton_Tomato" class="color"
                            data-color="#CD5C5C">Tomato</button>
                        <button style=background-color:Orange; id="buton_Orange" class="color"
                            data-color="#FF8C00">Orange</button>
                        <button style=background-color:DodgerBlue; id="buton_DodgerBlue" class="color"
                            data-color="#1E90FF">DodgerBlue</button>
                        <button style=background-color:MediumSeaGreen; id="buton_MediumSeaGreen" class="color"
                            data-color="#3CB371">MediumSeaGreen</button>
                        <button style=background-color:Gray; id="buton_Gray" class="color"
                            data-color="#808080">Gray</button>
                        <button style=background-color:SlateBlue; id="buton_SlateBlue" class="color"
                            data-color="#6A5ACD">SlateBlue</button>
                        <button style=background-color:Violet; id="buton_Violet" class="color"
                            data-color="#EE82EE">Violet</button>
                        <button style=background-color:LightGray; id="buton_LightGray" class="color"
                            data-color="#D3D3D3">LightGray</button>
                    </div>
                </div>


                <div class="slider">
                    <div class="slides">
                        <button class="slide selected" onclick="switchSrc(this, 'футболка')"
                            style="background-image: url('assets/футболка.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'жилетка')"
                            style="background-image: url('assets/жилетка.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'бушлат')"
                            style="background-image: url('assets/бушлат.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'комбез')"
                            style="background-image: url('assets/комбез.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'куртка')"
                            style="background-image: url('assets/куртка.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'одежда')"
                            style="background-image: url('assets/одежда.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'поварская_шапка')"
                            style="background-image: url('assets/поварская_шапка.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'поварской_китель')"
                            style="background-image: url('assets/поварской_китель.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'фартук')"
                            style="background-image: url('assets/фартук.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'футболка_с_воротом')"
                            style="background-image: url('assets/футболка_с_воротом.webp');">
                        </button><button class="slide" onclick="switchSrc(this, 'халат')"
                            style="background-image: url('assets/халат.webp');"></button>
                    </div>
                </div>
            </model-viewer>

            <script type="module">
                const modelViewerColor = document.querySelector("model-viewer#color");

                document.querySelector('#color-controls').addEventListener('click', (event) => {
                    const colorString = event.target.dataset.color;
                    const [material] = modelViewerColor.model.materials;
                    material.pbrMetallicRoughness.setBaseColorFactor(colorString);

                });
                const modelViewer = document.querySelector("model-viewer");
                window.switchSrc = (element, name) => {
                    const base = "assets/" + name;
                    modelViewer.src = base + '.glb';
                    modelViewer.poster = base + '.webp';
                    const slides = document.querySelectorAll(".slide");
                    slides.forEach((element) => { element.classList.remove("selected"); });
                    element.classList.add("selected");
                };

                document.querySelector(".slider").addEventListener('beforexrselect', (ev) => {
                    // Keep slider interactions from affecting the XR scene.
                    ev.preventDefault();
                });

            </script>
        </div>
        <div class="calculation-container">
            <div id="total-price">Сумма: 0 сум</div>
        </div>
        <div id="receipt">
            <h3>Чек:</h3>
        </div>
    </div>
</body>

</html>